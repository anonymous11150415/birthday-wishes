<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæ—¥å¿«ä¹ï¼</title>
    <style>
        /* å…¨å±€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            font-family: 'Arial', sans-serif;
            color: #333;
            overflow-x: hidden;
            background: #ffecd2;
        }

        /* å…¥åœºåŠ¨ç”»ç•Œé¢ */
        #entrance {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 1s ease-in-out;
        }

        #entrance.hidden {
            opacity: 0;
            pointer-events: none;
        }

        #entrance h1 {
            font-size: 3em;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            animation: bounce 2s infinite;
        }

        #entrance button {
            padding: 15px 30px;
            font-size: 1.2em;
            border: none;
            border-radius: 25px;
            background: white;
            color: #ff9a9e;
            cursor: pointer;
            transition: transform 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        #entrance button:hover {
            transform: scale(1.1);
        }

        /* ä¸»ç•Œé¢ */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .main-container.visible {
            opacity: 1;
        }

        /* å¡ç‰‡åŒºåŸŸ */
        .card-section {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 50px 0;
        }

        .birthday-card {
            position: relative;
            width: 300px;
            height: 400px;
            perspective: 1500px;
            margin: 20px;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.8s;
            cursor: pointer;
        }

        .birthday-card:hover .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .card-front {
            background: white;
        }

        .card-back {
            background: #ff9a9e;
            transform: rotateY(180deg);
            color: white;
        }

        /* è›‹ç³•åŒºåŸŸ */
        .cake-section {
            position: relative;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 50px 0;
        }

        /* ç…§ç‰‡å¢™åŒºåŸŸ */
        .photo-section {
            padding: 50px 0;
        }

        .photo-wall {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .photo-item {
            position: relative;
            padding-bottom: 100%;
            overflow: hidden;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .photo-item:hover {
            transform: scale(1.05);
        }

        .photo-item img {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* äº’åŠ¨åŒºåŸŸ */
        .interactive-section {
            min-height: 100vh;
            padding: 50px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: center;
        }

        /* æ¸¸æˆåŒºåŸŸæ ·å¼ */
        .games-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }

        .game-card {
            width: 300px;
            height: 200px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .game-card:hover {
            transform: translateY(-5px);
        }

        .game-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(255,255,255,0.9);
            transition: opacity 0.3s;
        }

        /* ç¤¼ç‰©ç›’æ ·å¼ */
        .gift-box-container {
            width: 150px;
            height: 150px;
            position: relative;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.5s;
        }

        .gift-box-lid {
            position: absolute;
            width: 100%;
            height: 30px;
            background: #ff4081;
            top: -30px;
            transform-origin: bottom;
            transition: transform 0.5s;
        }

        .gift-box-container.open .gift-box-lid {
            transform: rotateX(-110deg);
        }

        .gift-box-body {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff4081, #ff80ab);
            position: relative;
            transform-style: preserve-3d;
        }

        .gift-ribbon {
            position: absolute;
            width: 30px;
            height: 100%;
            background: #f50057;
            left: 50%;
            transform: translateX(-50%);
        }

        .gift-ribbon::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 30px;
            background: #f50057;
            top: 50%;
            left: -60px;
            transform: translateY(-50%) rotate(90deg);
        }

        /* æ„¿æœ›æ ‘æ ·å¼ */
        .wish-tree-container {
            width: 300px;
            height: 400px;
            position: relative;
        }

        .tree-trunk {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 100px;
            background: linear-gradient(45deg, #795548, #5d4037);
            border-radius: 5px;
        }

        .tree-crown {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 300px;
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            background: linear-gradient(45deg, #4caf50, #81c784);
        }

        .wish-leaf {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .wish-leaf:hover {
            transform: scale(1.2);
        }

        .wish-form {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }

        .wish-form input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .wish-form button {
            padding: 10px 20px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .wish-form button:hover {
            background: #45a049;
        }

        /* éŸ³ä¹æ§åˆ¶å™¨ */
        .music-controller {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* 3Dè›‹ç³•æ ·å¼ */
        .cake-container {
            position: relative;
            width: 300px;
            height: 300px;
            transform-style: preserve-3d;
            animation: rotate 20s infinite linear;
        }

        .cake-layer {
            position: absolute;
            width: 100%;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transform-style: preserve-3d;
        }

        .cake-layer-1 { 
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            transform: translateY(120px);
            width: 200px;
            height: 80px;
        }

        .cake-layer-2 {
            background: linear-gradient(45deg, #fad0c4, #ffd1ff);
            transform: translateY(80px);
            width: 240px;
            height: 70px;
        }

        .cake-layer-3 {
            background: linear-gradient(45deg, #ffd1ff, #ff9a9e);
            transform: translateY(40px);
            width: 280px;
            height: 60px;
        }

        .candle {
            position: absolute;
            width: 10px;
            height: 30px;
            background: #fff;
            top: -30px;
            border-radius: 5px;
            transform-style: preserve-3d;
        }

        .flame {
            position: absolute;
            width: 16px;
            height: 16px;
            background: #ffd700;
            border-radius: 50%;
            top: -16px;
            left: -3px;
            filter: blur(2px);
            animation: flicker 0.3s infinite alternate;
        }

        /* ç…§ç‰‡å¢™æ ·å¼å¢å¼º */
        .photo-item {
            transform: perspective(800px) rotateY(0deg);
            transition: transform 0.5s;
        }

        .photo-item:hover {
            transform: perspective(800px) rotateY(15deg) scale(1.1);
            box-shadow: -10px 10px 20px rgba(0,0,0,0.2);
        }

        .photo-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            transform: translateY(100%);
            transition: transform 0.3s;
        }

        .photo-item:hover .photo-caption {
            transform: translateY(0);
        }

        /* ç‰¹æ•ˆæ ·å¼ */
        .sparkle {
            position: absolute;
            pointer-events: none;
            animation: sparkle 1s forwards;
        }

        .heart {
            position: fixed;
            font-size: 20px;
            color: #ff4081;
            pointer-events: none;
            animation: float-up 3s forwards;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            pointer-events: none;
        }

        /* åŠ¨ç”»å…³é”®å¸§ */
        @keyframes rotate {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        @keyframes flicker {
            0% { transform: scale(0.9); opacity: 0.8; }
            100% { transform: scale(1.1); opacity: 1; }
        }

        @keyframes sparkle {
            0% { transform: scale(0) rotate(0deg); opacity: 1; }
            100% { transform: scale(1) rotate(180deg); opacity: 0; }
        }

        @keyframes float-up {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }

        @keyframes confetti-fall {
            0% { transform: translateY(-10px) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-container {
                padding: 10px;
            }

            .birthday-card {
                width: 280px;
                height: 380px;
            }

            .photo-wall {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }

        /* å€’è®¡æ—¶æ ·å¼ */
        .countdown-container {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 100;
            text-align: center;
        }

        .countdown-title {
            font-size: 16px;
            color: #ff4081;
            margin-bottom: 10px;
        }

        .countdown-time {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .countdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .countdown-number {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .countdown-label {
            font-size: 12px;
            color: #666;
        }

        /* éŸ³ä¹æ’­æ”¾åˆ—è¡¨æ ·å¼ */
        .music-playlist {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 100;
            max-width: 300px;
            display: none;
        }

        .playlist-title {
            font-size: 16px;
            color: #ff4081;
            margin-bottom: 10px;
            text-align: center;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            padding: 8px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .playlist-item:hover {
            background-color: rgba(255, 64, 129, 0.1);
        }

        .playlist-item.active {
            background-color: rgba(255, 64, 129, 0.2);
        }

        .playlist-item-title {
            flex-grow: 1;
            margin-left: 10px;
            font-size: 14px;
            color: #333;
        }

        .show-playlist {
            position: fixed;
            bottom: 20px;
            right: 80px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #ff4081;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 100;
        }

        /* åˆ†äº«åŠŸèƒ½æ ·å¼ */
        .share-container {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
        }

        .share-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #ff4081;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s;
        }

        .share-button:hover {
            transform: scale(1.1);
        }

        .share-menu {
            position: absolute;
            top: 50px;
            left: 0;
            background: white;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .share-menu.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .share-item {
            display: flex;
            align-items: center;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .share-item:hover {
            background-color: #f5f5f5;
        }

        .share-item i {
            margin-right: 10px;
            font-size: 20px;
        }

        /* è´ºå¡åŠŸèƒ½æ ·å¼ */
        .card-editor {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 800px;
            height: 80vh;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
            overflow: hidden;
        }

        .card-editor.active {
            display: flex;
        }

        .card-toolbar {
            width: 200px;
            background: #f5f5f5;
            padding: 20px;
            border-right: 1px solid #ddd;
            overflow-y: auto;
        }

        .card-preview {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            background: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card-template {
            width: 400px;
            height: 600px;
            position: relative;
            background: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .card-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .card-content {
            position: relative;
            z-index: 1;
            padding: 20px;
            color: #333;
        }

        .card-text {
            min-height: 100px;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid transparent;
            border-radius: 5px;
        }

        .card-text:focus {
            outline: none;
            border-color: #ff4081;
        }

        .decoration-item {
            width: 40px;
            height: 40px;
            margin: 5px;
            cursor: pointer;
            border-radius: 5px;
            transition: transform 0.2s;
        }

        .decoration-item:hover {
            transform: scale(1.1);
        }

        /* èƒŒæ™¯åŠ¨ç”»æ•ˆæœ */
        .floating-bubble {
            position: fixed;
            pointer-events: none;
            animation: float 20s linear infinite;
            opacity: 0.6;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(1);
            }
            100% {
                transform: translateY(-100px) scale(0);
            }
        }

        /* é¡µé¢åˆ‡æ¢åŠ¨ç”» */
        .page-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #ff4081;
            transform-origin: right;
            transform: scaleX(0);
            z-index: 9999;
        }

        .page-transition.active {
            animation: pageTransition 1s ease-in-out;
        }

        @keyframes pageTransition {
            0% {
                transform: scaleX(0);
            }
            50% {
                transform: scaleX(1);
            }
            100% {
                transform: scaleX(0);
            }
        }

        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            .cake-container {
                transform: scale(0.8);
            }

            .photo-wall {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }

            .game-card {
                width: 100%;
                max-width: 300px;
            }

            .card-editor {
                width: 95%;
                height: 90vh;
            }

            .card-toolbar {
                width: 100px;
            }

            .card-template {
                width: 300px;
                height: 450px;
            }

            .countdown-container {
                transform: scale(0.8);
                right: 10px;
                top: 10px;
            }

            .music-playlist {
                width: 250px;
                right: 10px;
            }
        }

        /* è§¦æ‘¸è®¾å¤‡ä¼˜åŒ– */
        @media (hover: none) {
            .game-card:hover {
                transform: none;
            }

            .share-button:hover {
                transform: none;
            }

            .decoration-item:hover {
                transform: none;
            }
        }
    </style>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>
<body>
    <!-- å…¥åœºåŠ¨ç”»ç•Œé¢ -->
    <div id="entrance">
        <h1>ğŸ‰ ç”Ÿæ—¥å¿«ä¹ï¼ ğŸ‚</h1>
        <button onclick="enterMain()">ç‚¹å‡»è¿›å…¥</button>
    </div>

    <!-- ä¸»ç•Œé¢ -->
    <div class="main-container">
        <!-- å¡ç‰‡åŒºåŸŸ -->
        <section class="card-section">
            <div class="birthday-card">
                <div class="card-inner">
                    <div class="card-front">
                        <h2>ç¥ä½ ç”Ÿæ—¥å¿«ä¹ï¼</h2>
                        <p>ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹ç¥ç¦</p>
                    </div>
                    <div class="card-back">
                        <h3>äº²çˆ±çš„æœ‹å‹</h3>
                        <p>æ„¿ä½ çš„ç”Ÿæ—¥å……æ»¡æ¬¢ä¹å’ŒæƒŠå–œ<br>
                           æ„¿ä½ æ‰€æœ‰çš„æ¢¦æƒ³éƒ½èƒ½å®ç°<br>
                           æ„¿ä½ çš„æœªæ¥å…‰æ˜è€Œç¾å¥½</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- è›‹ç³•åŒºåŸŸ -->
        <section class="cake-section">
            <div class="cake-container">
                <div class="cake-layer cake-layer-1"></div>
                <div class="cake-layer cake-layer-2"></div>
                <div class="cake-layer cake-layer-3">
                    <div class="candle">
                        <div class="flame" id="flame"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ç…§ç‰‡å¢™åŒºåŸŸ -->
        <section class="photo-section">
            <div class="photo-wall" id="photoWall">
                <!-- ç…§ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
            </div>
        </section>

        <!-- äº’åŠ¨åŒºåŸŸ -->
        <section class="interactive-section">
            <!-- æ¸¸æˆåŒºåŸŸ -->
            <div class="games-container">
                <div class="game-card" onclick="playBalloonGame()">
                    <div class="game-content">
                        <h3>æˆ³æ°”çƒæ¸¸æˆ</h3>
                        <p>ç‚¹å‡»å¼€å§‹ç©</p>
                    </div>
                </div>
                <div class="game-card" onclick="playMemoryGame()">
                    <div class="game-content">
                        <h3>è®°å¿†é…å¯¹</h3>
                        <p>ç‚¹å‡»å¼€å§‹ç©</p>
                    </div>
                </div>
                <div class="game-card" onclick="playPuzzleGame()">
                    <div class="game-content">
                        <h3>ç”Ÿæ—¥æ‹¼å›¾</h3>
                        <p>ç‚¹å‡»å¼€å§‹ç©</p>
                    </div>
                </div>
            </div>

            <!-- ç¤¼ç‰©ç›’ -->
            <div class="gift-box-container" onclick="toggleGift()">
                <div class="gift-box-lid"></div>
                <div class="gift-box-body">
                    <div class="gift-ribbon"></div>
                </div>
            </div>

            <!-- æ„¿æœ›æ ‘ -->
            <div class="wish-tree-container">
                <div class="tree-trunk"></div>
                <div class="tree-crown"></div>
            </div>

            <!-- æ„¿æœ›è¡¨å• -->
            <div class="wish-form" id="wishForm">
                <h3>å†™ä¸‹ä½ çš„æ„¿æœ›</h3>
                <input type="text" id="wishInput" placeholder="è¾“å…¥ä½ çš„æ„¿æœ›...">
                <button onclick="addWish()">æŒ‚ä¸Šæ„¿æœ›</button>
                <button onclick="closeWishForm()">å…³é—­</button>
            </div>
        </section>
    </div>

    <!-- åˆ†äº«åŠŸèƒ½ -->
    <div class="share-container">
        <button class="share-button" onclick="toggleShare()">ğŸ“¤</button>
        <div class="share-menu" id="shareMenu">
            <div class="share-item" onclick="shareToWeChat()">
                <i>ğŸ’¬</i> å¾®ä¿¡
            </div>
            <div class="share-item" onclick="shareToWeibo()">
                <i>ğŸŒ</i> å¾®åš
            </div>
            <div class="share-item" onclick="shareToQQ()">
                <i>ğŸ’«</i> QQ
            </div>
            <div class="share-item" onclick="copyLink()">
                <i>ğŸ”—</i> å¤åˆ¶é“¾æ¥
            </div>
        </div>
    </div>

    <!-- è´ºå¡ç¼–è¾‘å™¨ -->
    <div class="card-editor" id="cardEditor">
        <div class="card-toolbar">
            <h3>èƒŒæ™¯</h3>
            <div class="background-list">
                <img src="bg1.jpg" onclick="changeBackground('bg1.jpg')" class="decoration-item">
                <img src="bg2.jpg" onclick="changeBackground('bg2.jpg')" class="decoration-item">
                <img src="bg3.jpg" onclick="changeBackground('bg3.jpg')" class="decoration-item">
            </div>
            <h3>è£…é¥°</h3>
            <div class="decoration-list">
                <div onclick="addDecoration('ğŸ‚')" class="decoration-item">ğŸ‚</div>
                <div onclick="addDecoration('ğŸˆ')" class="decoration-item">ğŸˆ</div>
                <div onclick="addDecoration('ğŸ')" class="decoration-item">ğŸ</div>
                <div onclick="addDecoration('ğŸ‰')" class="decoration-item">ğŸ‰</div>
                <div onclick="addDecoration('ğŸ’')" class="decoration-item">ğŸ’</div>
            </div>
            <button onclick="saveCard()" style="margin-top: 20px;">ä¿å­˜è´ºå¡</button>
            <button onclick="closeCardEditor()" style="margin-top: 10px;">å…³é—­</button>
        </div>
        <div class="card-preview">
            <div class="card-template" id="cardTemplate">
                <img class="card-background" src="bg1.jpg">
                <div class="card-content">
                    <div class="card-text" contenteditable="true">åœ¨è¿™é‡Œå†™ä¸‹ä½ çš„ç¥ç¦...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- é¡µé¢åˆ‡æ¢åŠ¨ç”» -->
    <div class="page-transition"></div>

    <!-- éŸ³ä¹æ§åˆ¶å™¨ -->
    <div class="music-controller" onclick="toggleMusic()">
        ğŸµ
    </div>

    <!-- éŸ³é¢‘å…ƒç´  -->
    <audio id="bgMusic" loop>
        <source src="music/æ±Ÿå­˜æ½‡_-_è®°å¿†åšç‰©é¦†_(çº¯éŸ³ä¹ç‰ˆ)_.mp3" type="audio/mpeg">
    </audio>

    <!-- å€’è®¡æ—¶å®¹å™¨ -->
    <div class="countdown-container">
        <div class="countdown-title">è·ç¦»ç”Ÿæ—¥è¿˜æœ‰</div>
        <div class="countdown-time">
            <div class="countdown-item">
                <span class="countdown-number" id="countdown-days">00</span>
                <span class="countdown-label">å¤©</span>
            </div>
            <div class="countdown-item">
                <span class="countdown-number" id="countdown-hours">00</span>
                <span class="countdown-label">æ—¶</span>
            </div>
            <div class="countdown-item">
                <span class="countdown-number" id="countdown-minutes">00</span>
                <span class="countdown-label">åˆ†</span>
            </div>
            <div class="countdown-item">
                <span class="countdown-number" id="countdown-seconds">00</span>
                <span class="countdown-label">ç§’</span>
            </div>
        </div>
    </div>

    <!-- éŸ³ä¹æ’­æ”¾åˆ—è¡¨ -->
    <button class="show-playlist" onclick="togglePlaylist()">ğŸµ</button>
    <div class="music-playlist" id="musicPlaylist">
        <div class="playlist-title">ç”Ÿæ—¥æ­Œå•</div>
        <div class="playlist-item active" onclick="changeSong(0)">
            <span class="playlist-item-title">ç”Ÿæ—¥å¿«ä¹æ­Œ</span>
        </div>
        <div class="playlist-item" onclick="changeSong(1)">
            <span class="playlist-item-title">ç¥ä½ ç”Ÿæ—¥å¿«ä¹</span>
        </div>
        <div class="playlist-item" onclick="changeSong(2)">
            <span class="playlist-item-title">Happy Birthday To You</span>
        </div>
        <div class="playlist-item" onclick="changeSong(3)">
            <span class="playlist-item-title">ç”Ÿæ—¥ç¥ç¦æ­Œ</span>
        </div>
    </div>

    <script>
        // å…¥åœºåŠ¨ç”»æ§åˆ¶
        function enterMain() {
            document.getElementById('entrance').classList.add('hidden');
            document.querySelector('.main-container').classList.add('visible');
            // è‡ªåŠ¨æ’­æ”¾èƒŒæ™¯éŸ³ä¹
            document.getElementById('bgMusic').play().catch(() => {
                console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’');
            });
        }

        // éŸ³ä¹æ§åˆ¶
        function toggleMusic() {
            const audio = document.getElementById('bgMusic');
            if (audio.paused) {
                audio.play();
            } else {
                audio.pause();
            }
        }

        // ç…§ç‰‡å¢™åˆå§‹åŒ–
        const photos = [
            { url: 'images/35c2f6c8a7b4a5dee6eb5acc168bb1f.png', caption: 'ç¾å¥½çš„å›å¿†' },
            // å¯ä»¥æ·»åŠ æ›´å¤šç…§ç‰‡
        ];

        function initPhotoWall() {
            const photoWall = document.getElementById('photoWall');
            photos.forEach(photo => {
                const photoItem = document.createElement('div');
                photoItem.className = 'photo-item';
                
                const img = document.createElement('img');
                img.src = photo.url;
                img.alt = photo.caption;
                
                const caption = document.createElement('div');
                caption.className = 'photo-caption';
                caption.textContent = photo.caption;
                
                photoItem.appendChild(img);
                photoItem.appendChild(caption);
                photoWall.appendChild(photoItem);
            });
        }

        // ç‰¹æ•ˆå‡½æ•°
        function createSparkle(x, y) {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.style.left = x + 'px';
            sparkle.style.top = y + 'px';
            sparkle.style.backgroundColor = `hsl(${Math.random() * 360}, 70%, 50%)`;
            document.body.appendChild(sparkle);
            
            setTimeout(() => sparkle.remove(), 1000);
        }

        function createHeart(x, y) {
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.textContent = 'â¤';
            heart.style.left = x + 'px';
            heart.style.top = y + 'px';
            document.body.appendChild(heart);
            
            setTimeout(() => heart.remove(), 3000);
        }

        function createConfetti() {
            const colors = ['#ff4081', '#00bcd4', '#ffd700', '#64ffda', '#ff6e40'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * window.innerWidth + 'px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animation = `confetti-fall ${2 + Math.random() * 3}s linear forwards`;
                document.body.appendChild(confetti);
                
                setTimeout(() => confetti.remove(), 5000);
            }
        }

        // è›‹ç³•äº¤äº’
        function handleCakeClick() {
            const flame = document.getElementById('flame');
            if (flame.style.display !== 'none') {
                flame.style.display = 'none';
                createConfetti();
                for (let i = 0; i < 10; i++) {
                    setTimeout(() => {
                        createHeart(
                            Math.random() * window.innerWidth,
                            window.innerHeight
                        );
                    }, i * 300);
                }
            }
        }

        // é¼ æ ‡ç§»åŠ¨ç‰¹æ•ˆ
        document.addEventListener('mousemove', (e) => {
            if (Math.random() < 0.1) {
                createSparkle(e.clientX, e.clientY);
            }
        });

        // æ¸¸æˆç›¸å…³å‡½æ•°
        function playBalloonGame() {
            let score = 0;
            const gameArea = document.createElement('div');
            gameArea.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                z-index: 1000;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            `;

            const scoreDisplay = document.createElement('div');
            scoreDisplay.style.position = 'fixed';
            scoreDisplay.style.top = '20px';
            scoreDisplay.style.left = '20px';
            scoreDisplay.style.color = 'white';
            scoreDisplay.style.fontSize = '24px';
            scoreDisplay.textContent = `å¾—åˆ†: ${score}`;
            gameArea.appendChild(scoreDisplay);

            function createBalloon() {
                const balloon = document.createElement('div');
                balloon.style.position = 'absolute';
                balloon.style.left = Math.random() * (window.innerWidth - 50) + 'px';
                balloon.style.top = window.innerHeight + 'px';
                balloon.style.width = '50px';
                balloon.style.height = '60px';
                balloon.style.background = `hsl(${Math.random() * 360}, 70%, 50%)`;
                balloon.style.borderRadius = '50%';
                balloon.style.cursor = 'pointer';
                balloon.style.transition = 'top 3s linear';

                balloon.onclick = () => {
                    score += 1;
                    scoreDisplay.textContent = `å¾—åˆ†: ${score}`;
                    balloon.remove();
                    createConfetti();
                };

                gameArea.appendChild(balloon);
                setTimeout(() => {
                    balloon.style.top = '-60px';
                }, 100);

                setTimeout(() => balloon.remove(), 3000);
            }

            document.body.appendChild(gameArea);
            const gameInterval = setInterval(createBalloon, 1000);

            setTimeout(() => {
                clearInterval(gameInterval);
                gameArea.innerHTML = `
                    <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                         color: white; font-size: 24px; text-align: center;">
                        æ¸¸æˆç»“æŸï¼<br>
                        æœ€ç»ˆå¾—åˆ†: ${score}<br>
                        <button onclick="this.parentElement.parentElement.remove()" 
                                style="padding: 10px 20px; margin-top: 20px; cursor: pointer;">
                            å…³é—­
                        </button>
                    </div>
                `;
            }, 30000);
        }

        // è®°å¿†é…å¯¹æ¸¸æˆ
        function playMemoryGame() {
            const emojis = ['ğŸ‚', 'ğŸˆ', 'ğŸ', 'ğŸ‰', 'ğŸŠ', 'ğŸµ', 'ğŸ¸', 'ğŸº'];
            const cards = [...emojis, ...emojis];
            let flippedCards = [];
            let matchedPairs = 0;
            let canFlip = true;

            // åˆ›å»ºæ¸¸æˆåŒºåŸŸ
            const gameArea = document.createElement('div');
            gameArea.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                z-index: 1000;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            `;

            // åˆ›å»ºæ¸¸æˆå®¹å™¨
            const gameContainer = document.createElement('div');
            gameContainer.style.cssText = `
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 10px;
                padding: 20px;
                background: white;
                border-radius: 10px;
                max-width: 500px;
            `;

            // æ´—ç‰Œç®—æ³•
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            // åˆ›å»ºå¡ç‰‡
            shuffle(cards).forEach((emoji, index) => {
                const card = document.createElement('div');
                card.style.cssText = `
                    width: 100px;
                    height: 100px;
                    background: #ff4081;
                    border-radius: 10px;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    font-size: 40px;
                    cursor: pointer;
                    transition: transform 0.3s;
                    transform-style: preserve-3d;
                `;
                card.innerHTML = '<span style="display: none;">' + emoji + '</span>';
                
                card.onclick = () => {
                    if (!canFlip || card.classList.contains('flipped')) return;
                    
                    card.classList.add('flipped');
                    card.querySelector('span').style.display = 'block';
                    card.style.background = 'white';
                    flippedCards.push(card);

                    if (flippedCards.length === 2) {
                        canFlip = false;
                        const [card1, card2] = flippedCards;
                        
                        if (card1.textContent === card2.textContent) {
                            matchedPairs++;
                            flippedCards = [];
                            canFlip = true;
                            createConfetti();
                            
                            if (matchedPairs === emojis.length) {
                                setTimeout(() => {
                                    alert('æ­å–œä½ å®Œæˆäº†è®°å¿†é…å¯¹æ¸¸æˆï¼');
                                    gameArea.remove();
                                }, 500);
                            }
                        } else {
                            setTimeout(() => {
                                card1.classList.remove('flipped');
                                card2.classList.remove('flipped');
                                card1.querySelector('span').style.display = 'none';
                                card2.querySelector('span').style.display = 'none';
                                card1.style.background = '#ff4081';
                                card2.style.background = '#ff4081';
                                flippedCards = [];
                                canFlip = true;
                            }, 1000);
                        }
                    }
                };
                
                gameContainer.appendChild(card);
            });

            // æ·»åŠ å…³é—­æŒ‰é’®
            const closeButton = document.createElement('button');
            closeButton.textContent = 'å…³é—­æ¸¸æˆ';
            closeButton.style.cssText = `
                margin-top: 20px;
                padding: 10px 20px;
                background: #ff4081;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
            `;
            closeButton.onclick = () => gameArea.remove();

            gameArea.appendChild(gameContainer);
            gameArea.appendChild(closeButton);
            document.body.appendChild(gameArea);
        }

        // æ‹¼å›¾æ¸¸æˆ
        function playPuzzleGame() {
            const gameArea = document.createElement('div');
            gameArea.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                z-index: 1000;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            `;

            const puzzleContainer = document.createElement('div');
            puzzleContainer.style.cssText = `
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 2px;
                padding: 10px;
                background: white;
                border-radius: 10px;
                position: relative;
            `;

            const pieces = [];
            const size = 3;
            let emptyIndex = size * size - 1;

            // åˆ›å»ºæ‹¼å›¾å›¾æ¡ˆ
            function createPuzzlePattern(element, index) {
                const colors = ['#ff4081', '#3f51b5', '#4caf50', '#ffc107', '#9c27b0', '#00bcd4', '#ff5722', '#795548'];
                element.style.background = colors[index % colors.length];
                element.style.display = 'flex';
                element.style.justifyContent = 'center';
                element.style.alignItems = 'center';
                element.style.fontSize = '24px';
                element.style.color = 'white';
                element.textContent = index + 1;
            }

            // æ£€æŸ¥æ˜¯å¦å¯ä»¥ç§»åŠ¨
            function canMove(index) {
                const row = Math.floor(index / size);
                const col = index % size;
                const emptyRow = Math.floor(emptyIndex / size);
                const emptyCol = emptyIndex % size;
                
                return (
                    (Math.abs(row - emptyRow) === 1 && col === emptyCol) ||
                    (Math.abs(col - emptyCol) === 1 && row === emptyRow)
                );
            }

            // æ£€æŸ¥æ˜¯å¦å®Œæˆ
            function checkWin() {
                return pieces.every((piece, index) => {
                    return index === size * size - 1 || 
                           parseInt(piece.textContent) === index + 1;
                });
            }

            // åˆ›å»ºæ‹¼å›¾å—
            for (let i = 0; i < size * size; i++) {
                const piece = document.createElement('div');
                piece.style.cssText = `
                    width: 100px;
                    height: 100px;
                    border-radius: 5px;
                    cursor: pointer;
                    transition: transform 0.2s;
                `;

                if (i !== size * size - 1) {
                    createPuzzlePattern(piece, i);
                }

                piece.onclick = () => {
                    const index = pieces.indexOf(piece);
                    if (canMove(index)) {
                        // äº¤æ¢ä½ç½®
                        [pieces[index], pieces[emptyIndex]] = [pieces[emptyIndex], pieces[index]];
                        puzzleContainer.innerHTML = '';
                        pieces.forEach(p => puzzleContainer.appendChild(p));
                        emptyIndex = index;

                        if (checkWin()) {
                            createConfetti();
                            setTimeout(() => {
                                alert('æ­å–œä½ å®Œæˆäº†æ‹¼å›¾æ¸¸æˆï¼');
                                gameArea.remove();
                            }, 500);
                        }
                    }
                };

                pieces.push(piece);
            }

            // æ‰“ä¹±æ‹¼å›¾
            function shufflePuzzle() {
                for (let i = 0; i < 100; i++) {
                    const movablePieces = pieces.reduce((acc, piece, index) => {
                        if (canMove(index)) acc.push(index);
                        return acc;
                    }, []);

                    const randomIndex = movablePieces[Math.floor(Math.random() * movablePieces.length)];
                    [pieces[randomIndex], pieces[emptyIndex]] = [pieces[emptyIndex], pieces[randomIndex]];
                    emptyIndex = randomIndex;
                }
            }

            shufflePuzzle();
            pieces.forEach(piece => puzzleContainer.appendChild(piece));

            // æ·»åŠ å…³é—­æŒ‰é’®
            const closeButton = document.createElement('button');
            closeButton.textContent = 'å…³é—­æ¸¸æˆ';
            closeButton.style.cssText = `
                margin-top: 20px;
                padding: 10px 20px;
                background: #ff4081;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
            `;
            closeButton.onclick = () => gameArea.remove();

            gameArea.appendChild(puzzleContainer);
            gameArea.appendChild(closeButton);
            document.body.appendChild(gameArea);
        }

        // ç¤¼ç‰©ç›’åŠŸèƒ½
        function toggleGift() {
            const giftBox = document.querySelector('.gift-box-container');
            if (!giftBox.classList.contains('open')) {
                giftBox.classList.add('open');
                createConfetti();
                const surprises = [
                    'ğŸ æ”¶åˆ°ä¸€ä¸ªç¥ç§˜ç¤¼ç‰©ï¼',
                    'ğŸˆ è·å¾—ä¸€ä¸ªç”Ÿæ—¥æ°”çƒï¼',
                    'ğŸ‚ è·å¾—ä¸€å—è™šæ‹Ÿè›‹ç³•ï¼',
                    'ğŸ’ æ”¶åˆ°ä¸€ä»½ç‰¹åˆ«çš„ç¥ç¦ï¼',
                    'ğŸ‰ è·å¾—ä¸€ä¸ªæƒŠå–œåŒ…ï¼'
                ];
                const surprise = surprises[Math.floor(Math.random() * surprises.length)];
                setTimeout(() => {
                    alert(surprise);
                    giftBox.classList.remove('open');
                }, 1000);
            }
        }

        // æ„¿æœ›æ ‘åŠŸèƒ½
        let wishes = [];

        function addWish() {
            const wishText = document.getElementById('wishInput').value.trim();
            if (wishText) {
                wishes.push(wishText);
                createWishLeaf(wishText);
                closeWishForm();
                document.getElementById('wishInput').value = '';
            }
        }

        function createWishLeaf(text) {
            const leaf = document.createElement('div');
            leaf.className = 'wish-leaf';
            leaf.style.backgroundColor = `hsl(${Math.random() * 360}, 70%, 50%)`;
            leaf.title = text;
            
            // éšæœºä½ç½®ï¼Œä½†ç¡®ä¿åœ¨æ ‘å† èŒƒå›´å†…
            const treeCrown = document.querySelector('.tree-crown');
            const rect = treeCrown.getBoundingClientRect();
            const x = Math.random() * (rect.width - 30);
            const y = Math.random() * (rect.height - 30);
            
            leaf.style.left = x + 'px';
            leaf.style.top = y + 'px';
            
            treeCrown.appendChild(leaf);
        }

        function showWishForm() {
            document.getElementById('wishForm').style.display = 'block';
        }

        function closeWishForm() {
            document.getElementById('wishForm').style.display = 'none';
        }

        // åˆå§‹åŒ–ä¸€äº›æ„¿æœ›
        const initialWishes = [
            'ç”Ÿæ—¥å¿«ä¹ï¼',
            'å¿ƒæƒ³äº‹æˆï¼',
            'æ°¸è¿œå¼€å¿ƒï¼',
            'æ¢¦æƒ³æˆçœŸï¼'
        ];

        document.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–æ„¿æœ›æ ‘
            initialWishes.forEach(wish => {
                wishes.push(wish);
                createWishLeaf(wish);
            });

            // æ·»åŠ æ„¿æœ›æ ‘ç‚¹å‡»äº‹ä»¶
            document.querySelector('.wish-tree-container').addEventListener('click', (e) => {
                if (e.target.classList.contains('wish-leaf')) {
                    alert('æ„¿æœ›ï¼š' + e.target.title);
                } else {
                    showWishForm();
                }
            });

            initPhotoWall();
            
            // æ·»åŠ è›‹ç³•ç‚¹å‡»äº‹ä»¶
            const cake = document.querySelector('.cake-container');
            cake.addEventListener('click', handleCakeClick);
            
            // åˆ›å»ºä¸€äº›åˆå§‹çš„ç‰¹æ•ˆ
            setInterval(() => {
                if (Math.random() < 0.3) {
                    createHeart(
                        Math.random() * window.innerWidth,
                        window.innerHeight
                    );
                }
            }, 2000);
        });

        // å€’è®¡æ—¶åŠŸèƒ½
        function updateCountdown() {
            const birthday = new Date('2024-12-25T00:00:00'); // è®¾ç½®ç›®æ ‡ç”Ÿæ—¥æ—¥æœŸ
            const now = new Date();
            const diff = birthday - now;

            if (diff > 0) {
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);

                document.getElementById('countdown-days').textContent = String(days).padStart(2, '0');
                document.getElementById('countdown-hours').textContent = String(hours).padStart(2, '0');
                document.getElementById('countdown-minutes').textContent = String(minutes).padStart(2, '0');
                document.getElementById('countdown-seconds').textContent = String(seconds).padStart(2, '0');
            } else {
                document.querySelector('.countdown-container').innerHTML = `
                    <div class="countdown-title">ğŸ‰ ç”Ÿæ—¥å¿«ä¹ï¼ ğŸ‰</div>
                `;
            }
        }

        setInterval(updateCountdown, 1000);
        updateCountdown();

        // éŸ³ä¹æ’­æ”¾åˆ—è¡¨åŠŸèƒ½
        const playlist = [
            'birthday.mp3',
            'happy_birthday_chinese.mp3',
            'happy_birthday_english.mp3',
            'birthday_wish.mp3'
        ];

        let currentSong = 0;

        function togglePlaylist() {
            const playlist = document.getElementById('musicPlaylist');
            playlist.style.display = playlist.style.display === 'none' ? 'block' : 'none';
        }

        function changeSong(index) {
            if (index === currentSong) return;

            currentSong = index;
            const audio = document.getElementById('bgMusic');
            audio.src = playlist[index];
            audio.play();

            // æ›´æ–°æ´»åŠ¨é¡¹
            document.querySelectorAll('.playlist-item').forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });
        }

        // éŸ³ä¹è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€é¦–
        document.getElementById('bgMusic').addEventListener('ended', () => {
            currentSong = (currentSong + 1) % playlist.length;
            changeSong(currentSong);
        });

        // åˆ†äº«åŠŸèƒ½
        function toggleShare() {
            const shareMenu = document.getElementById('shareMenu');
            shareMenu.classList.toggle('active');
        }

        function shareToWeChat() {
            // ç”Ÿæˆåˆ†äº«äºŒç»´ç 
            const url = window.location.href;
            // è¿™é‡Œå¯ä»¥è°ƒç”¨å¾®ä¿¡åˆ†äº«API
            alert('è¯·æˆªå›¾ååœ¨å¾®ä¿¡ä¸­åˆ†äº«');
        }

        function shareToWeibo() {
            const text = 'é€ä¸Šæœ€çœŸæŒšçš„ç”Ÿæ—¥ç¥ç¦ï¼';
            const url = window.location.href;
            window.open(`http://service.weibo.com/share/share.php?url=${encodeURIComponent(url)}&title=${encodeURIComponent(text)}`);
        }

        function shareToQQ() {
            const text = 'é€ä¸Šæœ€çœŸæŒšçš„ç”Ÿæ—¥ç¥ç¦ï¼';
            const url = window.location.href;
            window.open(`http://connect.qq.com/widget/shareqq/index.html?url=${encodeURIComponent(url)}&title=${encodeURIComponent(text)}`);
        }

        function copyLink() {
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                alert('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }

        // è´ºå¡åŠŸèƒ½
        function openCardEditor() {
            document.getElementById('cardEditor').classList.add('active');
        }

        function closeCardEditor() {
            document.getElementById('cardEditor').classList.remove('active');
        }

        function changeBackground(bg) {
            document.querySelector('.card-background').src = bg;
        }

        function addDecoration(emoji) {
            const decoration = document.createElement('div');
            decoration.textContent = emoji;
            decoration.style.cssText = `
                position: absolute;
                font-size: 30px;
                cursor: move;
                user-select: none;
            `;
            
            // ä½¿è£…é¥°å¯æ‹–åŠ¨
            decoration.onmousedown = function(e) {
                const rect = document.querySelector('.card-template').getBoundingClientRect();
                const offsetX = e.clientX - decoration.offsetLeft;
                const offsetY = e.clientY - decoration.offsetTop;

                function onMouseMove(e) {
                    const x = e.clientX - rect.left - offsetX;
                    const y = e.clientY - rect.top - offsetY;
                    decoration.style.left = `${x}px`;
                    decoration.style.top = `${y}px`;
                }

                function onMouseUp() {
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                }

                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            };

            document.querySelector('.card-content').appendChild(decoration);
        }

        function saveCard() {
            html2canvas(document.querySelector('.card-template')).then(canvas => {
                const link = document.createElement('a');
                link.download = 'birthday-card.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        // èƒŒæ™¯åŠ¨ç”»
        function createBubble() {
            const bubble = document.createElement('div');
            bubble.className = 'floating-bubble';
            bubble.style.left = Math.random() * window.innerWidth + 'px';
            bubble.style.width = Math.random() * 30 + 20 + 'px';
            bubble.style.height = bubble.style.width;
            bubble.style.background = `hsla(${Math.random() * 360}, 70%, 50%, 0.3)`;
            bubble.style.borderRadius = '50%';
            document.body.appendChild(bubble);

            bubble.addEventListener('animationend', () => {
                bubble.remove();
            });
        }

        // å®šæœŸåˆ›å»ºæ°”æ³¡
        setInterval(createBubble, 2000);

        // é¡µé¢åˆ‡æ¢åŠ¨ç”»
        function transitionToPage(url) {
            const transition = document.querySelector('.page-transition');
            transition.classList.add('active');
            
            setTimeout(() => {
                window.location.href = url;
            }, 500);
            
            setTimeout(() => {
                transition.classList.remove('active');
            }, 1000);
        }

        // ç§»åŠ¨ç«¯è§¦æ‘¸äº‹ä»¶ä¼˜åŒ–
        document.addEventListener('touchstart', function() {
            // é˜²æ­¢é»˜è®¤æ»šåŠ¨è¡Œä¸º
            event.preventDefault();
        }, { passive: false });

        // æ€§èƒ½ä¼˜åŒ–
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // ä¼˜åŒ–æ»šåŠ¨äº‹ä»¶
        const optimizedScroll = debounce(function() {
            // å¤„ç†æ»šåŠ¨ç›¸å…³çš„è§†è§‰æ•ˆæœ
            const scrolled = window.scrollY;
            document.querySelectorAll('.photo-item').forEach(item => {
                const rect = item.getBoundingClientRect();
                if (rect.top < window.innerHeight && rect.bottom > 0) {
                    item.style.transform = `translateY(${scrolled * 0.1}px)`;
                }
            });
        }, 16);

        window.addEventListener('scroll', optimizedScroll);

        // æ·»åŠ é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–æ‰€æœ‰åŠŸèƒ½
            updateCountdown();
            createBubble();
            
            // æ£€æµ‹è®¾å¤‡ç±»å‹å¹¶ä¼˜åŒ–äº¤äº’
            if ('ontouchstart' in window) {
                document.body.classList.add('touch-device');
            }
            
            // é¢„åŠ è½½å›¾ç‰‡
            const images = ['bg1.jpg', 'bg2.jpg', 'bg3.jpg'];
            images.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        });
    </script>
</body>
</html>
